
var mpath = require('./')
var Bench = require('benchmark');
var sha = require('child_process').exec("git log --pretty=format:'%h' -n 1", function (err, sha) {
  if (err) throw err;

  var fs = require('fs')
  var filename = __dirname + '/bench.out';
  var out = fs.createWriteStream(filename, { flags: 'a', encoding: 'utf8' ***REMOVED***);

  /**
   * test doc creator
   */

  function doc () {
    var o = { first: { second: { third: [3,{ name: 'aaron' ***REMOVED***, 9] ***REMOVED******REMOVED******REMOVED***;
    o.comments = [
        { name: 'one' ***REMOVED***
      , { name: 'two', _doc: { name: '2' ***REMOVED******REMOVED***
      , { name: 'three'
          , comments: [{***REMOVED***,{ comments: [{val: 'twoo'***REMOVED***]***REMOVED***]
          , _doc: { name: '3', comments: [{***REMOVED***,{ _doc: { comments: [{ val: 2 ***REMOVED***] ***REMOVED******REMOVED***]  ***REMOVED******REMOVED***
    ];
    o.name = 'jiro';
    o.array = [
        { o: { array: [{x: {b: [4,6,8]***REMOVED******REMOVED***, { y: 10***REMOVED*** ] ***REMOVED******REMOVED***
      , { o: { array: [{x: {b: [1,2,3]***REMOVED******REMOVED***, { x: {z: 10 ***REMOVED******REMOVED***, { x: {b: 'hi'***REMOVED******REMOVED***] ***REMOVED******REMOVED***
      , { o: { array: [{x: {b: null ***REMOVED******REMOVED***, { x: { b: [null, 1]***REMOVED******REMOVED***] ***REMOVED******REMOVED***
      , { o: { array: [{x: null ***REMOVED***] ***REMOVED******REMOVED***
      , { o: { array: [{y: 3 ***REMOVED***] ***REMOVED******REMOVED***
      , { o: { array: [3, 0, null] ***REMOVED******REMOVED***
      , { o: { name: 'ha' ***REMOVED******REMOVED***
    ];
    o.arr = [
        { arr: [{ a: { b: 47 ***REMOVED******REMOVED***, { a: { c: 48 ***REMOVED******REMOVED***, { d: 'yep' ***REMOVED***] ***REMOVED***
      , { yep: true ***REMOVED***
    ]
    return o;
  ***REMOVED***

  var o = doc();

  var s = new Bench.Suite;
  s.add('mpath.get("first", obj)', function () {
    mpath.get('first', o);
  ***REMOVED***)
  s.add('mpath.get("first.second", obj)', function () {
    mpath.get('first.second', o);
  ***REMOVED***)
  s.add('mpath.get("first.second.third.1.name", obj)', function () {
    mpath.get('first.second.third.1.name', o);
  ***REMOVED***)
  s.add('mpath.get("comments", obj)', function () {
    mpath.get('comments', o);
  ***REMOVED***)
  s.add('mpath.get("comments.1", obj)', function () {
    mpath.get('comments.1', o);
  ***REMOVED***)
  s.add('mpath.get("comments.2.name", obj)', function () {
    mpath.get('comments.2.name', o);
  ***REMOVED***)
  s.add('mpath.get("comments.2.comments.1.comments.0.val", obj)', function () {
    mpath.get('comments.2.comments.1.comments.0.val', o);
  ***REMOVED***)
  s.add('mpath.get("comments.name", obj)', function () {
    mpath.get('comments.name', o);
  ***REMOVED***)

  s.add('mpath.set("first", obj, val)', function () {
    mpath.set('first', o, 1);
  ***REMOVED***)
  s.add('mpath.set("first.second", obj, val)', function () {
    mpath.set('first.second', o, 1);
  ***REMOVED***)
  s.add('mpath.set("first.second.third.1.name", obj, val)', function () {
    mpath.set('first.second.third.1.name', o, 1);
  ***REMOVED***)
  s.add('mpath.set("comments", obj, val)', function () {
    mpath.set('comments', o, 1);
  ***REMOVED***)
  s.add('mpath.set("comments.1", obj, val)', function () {
    mpath.set('comments.1', o, 1);
  ***REMOVED***)
  s.add('mpath.set("comments.2.name", obj, val)', function () {
    mpath.set('comments.2.name', o, 1);
  ***REMOVED***)
  s.add('mpath.set("comments.2.comments.1.comments.0.val", obj, val)', function () {
    mpath.set('comments.2.comments.1.comments.0.val', o, 1);
  ***REMOVED***)
  s.add('mpath.set("comments.name", obj, val)', function () {
    mpath.set('comments.name', o, 1);
  ***REMOVED***)

  s.on('start', function () {
    console.log('starting...');
    out.write('*' + sha + ': ' + String(new Date()) + '\n');
  ***REMOVED***);
  s.on('cycle', function (e) {
    var s = String(e.target);
    console.log(s);
    out.write(s + '\n');
  ***REMOVED***)
  s.on('complete', function () {
    console.log('done')
    out.end('');
  ***REMOVED***)
  s.run()
***REMOVED***)

