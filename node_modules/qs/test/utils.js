'use strict';

var test = require('tape');
var utils = require('../lib/utils');

test('merge()', function (t) {
    t.deepEqual(utils.merge({ a: 'b' ***REMOVED***, { a: 'c' ***REMOVED***), { a: ['b', 'c'] ***REMOVED***, 'merges two objects with the same key');

    var oneMerged = utils.merge({ foo: 'bar' ***REMOVED***, { foo: { first: '123' ***REMOVED*** ***REMOVED***);
    t.deepEqual(oneMerged, { foo: ['bar', { first: '123' ***REMOVED***] ***REMOVED***, 'merges a standalone and an object into an array');

    var twoMerged = utils.merge({ foo: ['bar', { first: '123' ***REMOVED***] ***REMOVED***, { foo: { second: '456' ***REMOVED*** ***REMOVED***);
    t.deepEqual(twoMerged, { foo: { 0: 'bar', 1: { first: '123' ***REMOVED***, second: '456' ***REMOVED*** ***REMOVED***, 'merges a standalone and two objects into an array');

    var sandwiched = utils.merge({ foo: ['bar', { first: '123', second: '456' ***REMOVED***] ***REMOVED***, { foo: 'baz' ***REMOVED***);
    t.deepEqual(sandwiched, { foo: ['bar', { first: '123', second: '456' ***REMOVED***, 'baz'] ***REMOVED***, 'merges an object sandwiched by two standalones into an array');

    var nestedArrays = utils.merge({ foo: ['baz'] ***REMOVED***, { foo: ['bar', 'xyzzy'] ***REMOVED***);
    t.deepEqual(nestedArrays, { foo: ['baz', 'bar', 'xyzzy'] ***REMOVED***);

    t.end();
***REMOVED***);

test('assign()', function (t) {
    var target = { a: 1, b: 2 ***REMOVED***;
    var source = { b: 3, c: 4 ***REMOVED***;
    var result = utils.assign(target, source);

    t.equal(result, target, 'returns the target');
    t.deepEqual(target, { a: 1, b: 3, c: 4 ***REMOVED***, 'target and source are merged');
    t.deepEqual(source, { b: 3, c: 4 ***REMOVED***, 'source is untouched');

    t.end();
***REMOVED***);
